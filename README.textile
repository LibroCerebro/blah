h1. Bl@h - Blacklight at Hull

Bl@h is the University of Hull's instance of the blacklight search and discovery interface.  For more information about Blacklight...

Blacklight Project site: "http://projectblacklight.org/":http://projectblacklight.org/
Blacklight github: "https://github.com/projectblacklight/blacklight:":https://github.com/projectblacklight/blacklight

h2. Requirements

ruby-1.9.3-p448
java 1.5 or higher (in order to run solr under a jetty)
RVM (recommended for development)

In addition, you should have Bundler and Rails ruby gems installed:

<pre>gem install bundler
gem install rails
</pre>

h2. Installation guide

<pre>
git checkout git@github.com:uohull/blah.git
</pre>

Change the current directory to "blah"

The project includes a .rvmrc file which will define a Ruby version and gemset that should be used for the project.  In this case ruby-1.9.3-p448 and gemset 'blah'.  

To install the required gems, execute:
<pre>
bundle install
</pre>

To create the necessary blacklight database tables, run the database migrations:
<pre>
rake db:migrate
</pre>

h2. Running...

The configurations for the Blah application are stored in config/blah_config.yml.

To run you must first ensure that the local Solr server is running, by navigating blah/jetty directory and..
<pre>
java -jar start.jar &
</pre>

Index test MARC records using the existing rake task...
<pre>rake solr:marc:index_test_data</pre>

Start the rails application:
<pre>rails server</pre>

h2. Indexing test data

h3. Electronic resources

Electronic resources are indexed into solr from a locally produced csv file. A sample file is located in test/fixtures/e-resource.csv (this is used in the examples below).  The following rake tasks exist.  

To index electronic resources... 
<pre>rake blah:electronic_resources:index_data  CSV_FILE_PATH=./test/fixtures/e-resources.csv</pre>

To Delete electronic resources from the index...
<pre>rake blah:electronic_resources:delete_data</pre>

To delete, and then re-index a csv...
<pre>rake blah:electronic_resources:delete_and_index_data  CSV_FILE_PATH=./test/fixtures/e-resources.csv</pre>

Setting the RAILS_ENV variable will utilise the Solr instance attached to the rails env (defined in config/solr.yml) i.e.
<pre># This will delete existing electronic resources and then index the electronic resources data into the production instance of solr specified in solr.yml
  RAILS_ENV=production rake blah:electronic_resources:delete_and_index_data  CSV_FILE_PATH=./test/fixtures/e-resources.csv</pre>
